import{j as s}from"./index-BZchTVqk.js";import{u as c}from"./index-CFAftGZl.js";function n(e){const l={a:"a",code:"code",div:"div",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...c(),...e.components};return s.jsxs(s.Fragment,{children:[s.jsx(l.p,{children:"Recently, I have been working on a project that requires me to support both JavaScript and Rust plugins. I have been using GitHub Actions to deploy the plugins, and I wanted to share how I managed to support both JavaScript and Rust plugins in the same repository."}),`
`,s.jsxs(l.h2,{id:"rust-plugins",children:["Rust Plugins",s.jsx(l.a,{className:"header-anchor",href:"#rust-plugins",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsxs(l.h3,{id:"building-rust-plugins",children:["Building Rust Plugins",s.jsx(l.a,{className:"header-anchor",href:"#building-rust-plugins",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsx(l.p,{children:"Bacause of rust plugin need support multi-platform, so we should build in multi-platform before deploy to npm registry."}),`
`,s.jsxs(l.pre,{className:"shiki dark-plus",style:{backgroundColor:"#1E1E1E",color:"#D4D4D4"},children:[s.jsx(l.div,{className:"language-id",children:"yaml"}),s.jsx(l.div,{className:"code-container",children:s.jsxs(l.code,{children:[s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Building Rust Binding And Upload Artifacts"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"on"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"workflow_call"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"jobs"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"  "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"build"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Build and Upload Artifacts - ${{ matrix.settings.abi }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"runs-on"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ matrix.settings.os }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"strategy"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"fail-fast"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"false"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"matrix"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"settings"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ubuntu-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"docker"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ghcr.io/napi-rs/napi-rs/nodejs-rust:lts-debian"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"linux-x64-gnu"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"build"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:">"}),s.jsx(l.span,{style:{color:"#569CD6"},children:"-"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              git config --global --add safe.directory /build &&"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              set -e &&"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              unset CC_x86_64_unknown_linux_gnu &&"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              unset CC &&"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'              pnpm --filter "{rust-plugins}[HEAD~1]" --sequential build --target x86_64-unknown-linux-gnu --abi linux-x64-gnu'})}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ubuntu-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"docker"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ghcr.io/napi-rs/napi-rs/nodejs-rust:lts-alpine"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"linux-x64-musl"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"build"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:">"}),s.jsx(l.span,{style:{color:"#569CD6"},children:"-"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              git config --global --add safe.directory /build &&"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              set -e &&"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              unset CC_x86_64_unknown_linux_musl &&"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              unset CC &&"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'              pnpm  --filter "{rust-plugins}[HEAD~1]" --sequential build --target x86_64-unknown-linux-musl --abi linux-x64-musl'})}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"windows-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"win32-x64-msvc"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"macos-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"darwin-arm64"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"macos-13"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"darwin-x64"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# cross compile"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# windows. Note swc plugins is not supported on ia32 and arm64"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"windows-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"win32-ia32-msvc"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"target"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"i686-pc-windows-msvc"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"build"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              export CARGO_PROFILE_RELEASE_LTO=false"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              cargo install cargo-xwin --locked"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'              pnpm --filter "{rust-plugins}[HEAD~1]" --sequential build --target i686-pc-windows-msvc --abi win32-ia32-msvc --cargo-flags="--no-default-features"'})}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"windows-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"win32-arm64-msvc"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"target"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"aarch64-pc-windows-msvc"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"build"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              export CARGO_PROFILE_RELEASE_CODEGEN_UNITS=256"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              export CARGO_PROFILE_RELEASE_LTO=false"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              cargo install cargo-xwin --locked"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'              pnpm --filter "{rust-plugins}[HEAD~1]" --sequential build --target aarch64-pc-windows-msvc --abi win32-arm64-msvc --cargo-flags="--no-default-features"'})}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# linux"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ubuntu-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"linux-arm64-musl"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"target"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"aarch64-unknown-linux-musl"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"zig"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"true"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"os"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ubuntu-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"abi"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"linux-arm64-gnu"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"target"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"aarch64-unknown-linux-gnu"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"zig"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"true"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"steps"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/checkout@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"fetch-depth"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#B5CEA8"},children:"2"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# - run: |"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# git fetch --no-tags --prune --depth=1 origin +refs/heads/main:refs/remotes/HEAD~1"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Cache rust artifacts"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Swatinem/rust-cache@v2"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"shared-key"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"rust-build-${{ matrix.settings.abi }}"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/setup-node@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"node-version"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#B5CEA8"},children:"18"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Install Dependencies"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"npm config set registry https://registry.npmmirror.com && npm install -g pnpm@9.1.0 && pnpm i --frozen-lockfile"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"rustup target add ${{ matrix.settings.target }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ matrix.settings.target }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# Use the v1 of this action"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"mbround18/setup-osxcross@v1"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ matrix.settings.osxcross }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# This builds executables & sets env variables for rust to consume."})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"osx-version"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"'12.3'"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"goto-bus-stop/setup-zig@v2"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ matrix.settings.zig }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Build in docker"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"addnab/docker-run-action@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ matrix.settings.docker }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"image"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ matrix.settings.docker }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"options"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"-v ${{ env.HOME }}/.cargo/git:/root/.cargo/git -v ${{ env.HOME }}/.cargo/registry:/root/.cargo/registry -v ${{ github.workspace }}:/build -w /build"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ matrix.settings.build }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Default Build"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ !matrix.settings.docker && !matrix.settings.build }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          pnpm --filter \"{rust-plugins}[HEAD~1]\" --sequential build --abi ${{ matrix.settings.abi }} ${{ matrix.settings.target && format('--target {0}', matrix.settings.target) || '' }} ${{ matrix.settings.zig && '--zig' || '' }}"})}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"shell"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"bash"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Build"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ !matrix.settings.docker && matrix.settings.build }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ matrix.settings.build }}"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"shell"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"bash"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Upload Plugin dsv"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/upload-artifact@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ github.sha }}-${{ matrix.settings.abi }}-dsv"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"path"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"./rust-plugins/dsv/npm/${{ matrix.settings.abi }}/index.farm"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if-no-files-found"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ignore"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# other packages upload"})]})]})})]}),`
`,s.jsxs(l.p,{children:["In the above ci config, first we build defferent platform rust plugins. But in then build step, we use ",s.jsx(l.code,{children:'pnpm --filter "{rust-plugins}[HEAD~1]"'})," to build only changed rust plugins. This is very important, because we don't want to build all rust plugins every time. Then filter only build changed rust plugins under ",s.jsx(l.code,{children:"rust-plugins"})," directory."]}),`
`,s.jsxs(l.h3,{id:"deploying-rust-plugins",children:["Deploying Rust Plugins",s.jsx(l.a,{className:"header-anchor",href:"#deploying-rust-plugins",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsxs(l.pre,{className:"shiki dark-plus",style:{backgroundColor:"#1E1E1E",color:"#D4D4D4"},children:[s.jsx(l.div,{className:"language-id",children:"yaml"}),s.jsx(l.div,{className:"code-container",children:s.jsxs(l.code,{children:[s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Publish packages and crates"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"on"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"  "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"push"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"branches"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"main"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"concurrency"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"${{ github.workflow }}-${{ github.ref }}"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"jobs"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"  "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"call-rust-build"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"contains(github.event.head_commit.message, 'rust-plugins') || contains(github.event.head_commit.message, 'all')"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"./.github/workflows/build.yaml"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"  "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"release"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Release"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"contains(github.event.head_commit.message, 'rust-plugins') || contains(github.event.head_commit.message, 'all')"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"needs"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": ["}),s.jsx(l.span,{style:{color:"#CE9178"},children:"call-rust-build"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"]"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"runs-on"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ubuntu-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"steps"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Checkout Repo"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/checkout@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"fetch-depth"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#B5CEA8"},children:"2"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          git fetch --no-tags --prune --depth=1 origin +refs/heads/main:refs/remotes/HEAD~1"})}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Setup Node.js 18.x"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/setup-node@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"node-version"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"18.x"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# batch download artifacts"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/download-artifact@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"path"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"/tmp/artifacts"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Move Artifacts"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          for abi in linux-x64-gnu linux-x64-musl darwin-x64 win32-x64-msvc linux-arm64-musl linux-arm64-gnu darwin-arm64 win32-ia32-msvc win32-arm64-msvc"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          do"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"             for package in dsv react-components virtual yaml strip image url icons auto-import mdx"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              do"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'                folder_path="/tmp/artifacts/${{github.sha}}-${abi}-${package}"'})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'                if [ -d "${folder_path}" ] && [ -n "$(ls -A $folder_path)" ]; then'})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"                  mv /tmp/artifacts/${{ github.sha }}-${abi}-${package}/* ./packages/${package}/npm/${abi}"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"                  ls -R $folder_path"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"                  ls -R ./packages/${package}/npm/${abi}"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"                  test -f ./packages/${package}/npm/${abi}/index.farm"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"                else"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'                  echo "${folder_path} is empty"'})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"                fi"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"              done"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          done"})}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Install Dependencies"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"npm install -g pnpm@9.1.0 && pnpm i --frozen-lockfile"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Publish to npm"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'          npm set //registry.npmjs.org/:_authToken=${{ secrets.NPM_TOKEN }} && npm config set access public && pnpm --filter "{rust-plugins}[HEAD~1]" publish --no-git-checks'})})]})})]}),`
`,s.jsxs(l.p,{children:["In the above ci config, we use ",s.jsx(l.code,{children:"contains"})," to determine whether to run the ci. If the commit message contains ",s.jsx(l.code,{children:"rust-plugins"})," or ",s.jsx(l.code,{children:"all"}),", then we run the ci. In the ",s.jsx(l.code,{children:"release"})," job, we first download the artifacts that we built in the previous ci. Then we move the artifacts to the corresponding directory. Finally, we publish the rust plugins to the npm registry."]}),`
`,s.jsxs(l.h2,{id:"javascript-plugins",children:["JavaScript Plugins",s.jsx(l.a,{className:"header-anchor",href:"#javascript-plugins",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsxs(l.h3,{id:"building-javascript-plugins",children:["Building JavaScript Plugins",s.jsx(l.a,{className:"header-anchor",href:"#building-javascript-plugins",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsxs(l.pre,{className:"shiki dark-plus",style:{backgroundColor:"#1E1E1E",color:"#D4D4D4"},children:[s.jsx(l.div,{className:"language-id",children:"yaml"}),s.jsx(l.div,{className:"code-container",children:s.jsxs(l.code,{children:[s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"PR build plugins"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"on"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"workflow_call"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"jobs"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"  "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"build"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"runs-on"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ubuntu-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"release"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"steps"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/checkout@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"fetch-depth"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#B5CEA8"},children:"2"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# - run: |"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      "}),s.jsx(l.span,{style:{color:"#6A9955"},children:"# git fetch --no-tags --prune --depth=1 origin +refs/heads/main:refs/remotes/HEAD~1"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Setup Node"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/setup-node@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"node-version"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#B5CEA8"},children:"20"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"registry-url"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"https://registry.npmjs.org/"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Enable Corepack"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"id"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"pnpm-setup"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          corepack enable"})}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Initliaze .npmrc"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:">"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'          echo -e "//registry.npmjs.org/:_authToken=${{ secrets.NPM_TOKEN }}\\n$(cat .npmrc)" > .npmrc'})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          && cat -n .npmrc"})}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"pnpm install"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"pnpm install --frozen-lockfile"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Build Packages"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'          pnpm --filter "{js-plugins}[HEAD~1]" build'})})]})})]}),`
`,s.jsxs(l.p,{children:["the config is as same as rust plugins, but we use ",s.jsx(l.code,{children:'pnpm --filter "{js-plugins}[HEAD~1]" build'})," to build only changed js plugins."]}),`
`,s.jsxs(l.h3,{id:"deploying-javascript-plugins",children:["Deploying JavaScript Plugins",s.jsx(l.a,{className:"header-anchor",href:"#deploying-javascript-plugins",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsxs(l.pre,{className:"shiki dark-plus",style:{backgroundColor:"#1E1E1E",color:"#D4D4D4"},children:[s.jsx(l.div,{className:"language-id",children:"yaml"}),s.jsx(l.div,{className:"code-container",children:s.jsxs(l.code,{children:[s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Release Packages"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"on"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"  "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"push"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"branches"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"main"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"jobs"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"  "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"release"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"runs-on"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"ubuntu-latest"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"contains(github.event.head_commit.message, 'js-plugins') || contains(github.event.head_commit.message, 'all')"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"release"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"steps"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Checkout repo"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/checkout@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"fetch-depth"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#B5CEA8"},children:"2"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Setup Node"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"uses"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"actions/setup-node@v3"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"with"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:":"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"node-version"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#B5CEA8"},children:"20"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"          "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"registry-url"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"https://registry.npmjs.org/"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Enable Corepack"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"id"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"pnpm-setup"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          corepack enable"})}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Initliaze .npmrc"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:">"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'          echo -e "//registry.npmjs.org/:_authToken=${{ secrets.NPM_TOKEN }}\\n$(cat .npmrc)" > .npmrc'})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:"          && cat -n .npmrc"})}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"pnpm install"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"pnpm install --frozen-lockfile"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Build Packages"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'          pnpm --filter "{js-plugins}[HEAD~1]" build'})}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"      - "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"name"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#CE9178"},children:"Release and Publish Packages"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"run"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"|"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#CE9178"},children:'          npm set //registry.npmjs.org/:_authToken=${{ secrets.NPM_TOKEN }} && npm config set access public && pnpm --filter "{js-plugins}[HEAD~1]" publish --no-git-checks'})})]})})]}),`
`,s.jsx(l.p,{children:"the relase config is as same as rust plugins too."}),`
`,s.jsxs(l.h3,{id:"summary",children:["Summary",s.jsx(l.a,{className:"header-anchor",href:"#summary",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsxs(l.ul,{children:[`
`,s.jsxs(l.li,{children:["use ",s.jsx(l.code,{children:'pnpm --filter "{xx}[HEAD~1]"'})," to build only changed to reduce build time."]}),`
`,s.jsxs(l.li,{children:["use ",s.jsx(l.code,{children:"contains"})," to determine whether to run the ci."]}),`
`]})]})}function o(e={}){const{wrapper:l}={...c(),...e.components};return l?s.jsx(l,{...e,children:s.jsx(n,{...e})}):n(e)}export{o as default};
