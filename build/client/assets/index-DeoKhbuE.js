import{r as a,j as e}from"./index-BZchTVqk.js";import{l as W}from"./_virtual_blog-list-BdbUaUNp.js";import{u as E,c as w}from"./i18n-provider-Cit72E0b.js";import{w as G,L as D,O as Y,N as K}from"./components-raYoEFov.js";import{c as T}from"./createLucideIcon-v75W40Ay.js";import{M as X,i as J,u as M,P as Q,a as Z,b as ee,L as te,m as b}from"./proxy-4eBiWsw0.js";import{M as ne,L as se}from"./license-notice-wyIg2vAp.js";const N={SCROLL_TO_TOP_THRESHOLD:500,HEADING_HIGHLIGHT_OFFSET:120,HIGHLIGHT_BUFFER:50,SCROLL_BEHAVIOR:"smooth"},oe=".scroll-container",z=t=>t||(document.querySelector(oe)??window),F=t=>t.scrollTop,re=(t,o)=>{if(o===window)return t.getBoundingClientRect().top+window.scrollY;const n=o,s=n.getBoundingClientRect(),i=t.getBoundingClientRect();return F(n)+(i.top-s.top)},ie=(t,o={})=>{if(!t)return!1;const n=document.getElementById(t);if(!n)return!1;const{offset:s=N.HEADING_HIGHLIGHT_OFFSET,behavior:i=N.SCROLL_BEHAVIOR,container:r=null}=o,l=z(r),c=re(n,l)-s;return l===window?window.scrollTo({top:c,behavior:i}):l.scrollTo({top:c,behavior:i}),!0},le=t=>{const o=z(t);return o===window?window.scrollY:F(o)},ae=(t={})=>{const{behavior:o=N.SCROLL_BEHAVIOR,container:n=null}=t,s=z(n);if(s===window){window.scrollTo({top:0,behavior:o});return}s.scrollTo({top:0,behavior:o})};function A(t,o){let n=0,s=null;return(...i)=>{const r=Date.now(),l=o-(r-n);if(l<=0){s&&(clearTimeout(s),s=null),n=r,t(...i);return}s||(s=setTimeout(()=>{n=Date.now(),s=null,t(...i)},l))}}/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=T("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=T("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=T("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=T("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=T("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]]);function P(t,o){if(typeof t=="function")return t(o);t!=null&&(t.current=o)}function he(...t){return o=>{let n=!1;const s=t.map(i=>{const r=P(i,o);return!n&&typeof r=="function"&&(n=!0),r});if(n)return()=>{for(let i=0;i<s.length;i++){const r=s[i];typeof r=="function"?r():P(t[i],null)}}}}function xe(...t){return a.useCallback(he(...t),t)}class pe extends a.Component{getSnapshotBeforeUpdate(o){const n=this.props.childRef.current;if(n&&o.isPresent&&!this.props.isPresent){const s=n.offsetParent,i=J(s)&&s.offsetWidth||0,r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft,r.right=i-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function ge({children:t,isPresent:o,anchorX:n,root:s}){const i=a.useId(),r=a.useRef(null),l=a.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=a.useContext(X),m=xe(r,t==null?void 0:t.ref);return a.useInsertionEffect(()=>{const{width:d,height:u,top:f,left:h,right:g}=l.current;if(o||!r.current||!d||!u)return;const y=n==="left"?`left: ${h}`:`right: ${g}`;r.current.dataset.motionPopId=i;const p=document.createElement("style");c&&(p.nonce=c);const k=s??document.head;return k.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${u}px !important;
            ${y}px !important;
            top: ${f}px !important;
          }
        `),()=>{k.contains(p)&&k.removeChild(p)}},[o]),e.jsx(pe,{isPresent:o,childRef:r,sizeRef:l,children:a.cloneElement(t,{ref:m})})}const ve=({children:t,initial:o,isPresent:n,onExitComplete:s,custom:i,presenceAffectsLayout:r,mode:l,anchorX:c,root:m})=>{const d=M(we),u=a.useId();let f=!0,h=a.useMemo(()=>(f=!1,{id:u,initial:o,isPresent:n,custom:i,onExitComplete:g=>{d.set(g,!0);for(const y of d.values())if(!y)return;s&&s()},register:g=>(d.set(g,!1),()=>d.delete(g))}),[n,d,s]);return r&&f&&(h={...h}),a.useMemo(()=>{d.forEach((g,y)=>d.set(y,!1))},[n]),a.useEffect(()=>{!n&&!d.size&&s&&s()},[n]),l==="popLayout"&&(t=e.jsx(ge,{isPresent:n,anchorX:c,root:m,children:t})),e.jsx(Q.Provider,{value:h,children:t})};function we(){return new Map}const L=t=>t.key||"";function B(t){const o=[];return a.Children.forEach(t,n=>{a.isValidElement(n)&&o.push(n)}),o}const O=({children:t,custom:o,initial:n=!0,onExitComplete:s,presenceAffectsLayout:i=!0,mode:r="sync",propagate:l=!1,anchorX:c="left",root:m})=>{const[d,u]=Z(l),f=a.useMemo(()=>B(t),[t]),h=l&&!d?[]:f.map(L),g=a.useRef(!0),y=a.useRef(f),p=M(()=>new Map),[k,V]=a.useState(f),[j,I]=a.useState(f);ee(()=>{g.current=!1,y.current=f;for(let v=0;v<j.length;v++){const x=L(j[v]);h.includes(x)?p.delete(x):p.get(x)!==!0&&p.set(x,!1)}},[j,h.length,h.join("-")]);const R=[];if(f!==k){let v=[...f];for(let x=0;x<j.length;x++){const C=j[x],H=L(C);h.includes(H)||(v.splice(x,0,C),R.push(C))}return r==="wait"&&R.length&&(v=R),I(B(v)),V(f),null}const{forceRender:S}=a.useContext(te);return e.jsx(e.Fragment,{children:j.map(v=>{const x=L(v),C=l&&!d?!1:f===j||h.includes(x),H=()=>{if(p.has(x))p.set(x,!0);else return;let _=!0;p.forEach(q=>{q||(_=!1)}),_&&(S==null||S(),I(y.current),l&&(u==null||u()),s&&s())};return e.jsx(ve,{isPresent:C,initial:!g.current||n?void 0:!1,custom:o,presenceAffectsLayout:i,mode:r,root:m,onExitComplete:C?void 0:H,anchorX:c,children:v},x)})})};function ye({list:t,className:o}){const{pathname:n}=G(),{t:s}=E(),i=t.findIndex(c=>c.url===n),r=i>0?t[i-1]:null,l=i<t.length-1?t[i+1]:null;return e.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:w("w-full space-y-6",o),children:(r||l)&&e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx("div",{className:"flex justify-start",children:r?e.jsxs(D,{to:r.url,className:w("group flex items-center gap-3 rounded-xl p-4","from-muted/50 bg-gradient-to-r to-transparent","border-border/30 hover:border-border/60 border","transition-all duration-300","hover:from-muted/80 hover:to-muted/20 hover:bg-gradient-to-r","transform hover:-translate-y-1 hover:shadow-lg","w-full max-w-sm"),children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ue,{className:"text-muted-foreground group-hover:text-foreground h-5 w-5 transition-colors"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-muted-foreground mb-1 text-xs font-medium",children:s("blog.detail.previousPost")}),e.jsx("div",{className:"group-hover:text-gray-700 truncate text-sm font-medium transition-colors",children:r.title})]})]}):e.jsx("div",{className:"w-full max-w-sm"})}),e.jsx("div",{className:"flex justify-end",children:l?e.jsxs(D,{to:l.url,className:w("group flex items-center gap-3 rounded-xl p-4","from-muted/50 bg-gradient-to-l to-transparent","border-border/30 hover:border-border/60 border","transition-all duration-300","hover:from-muted/80 hover:to-muted/20 hover:bg-gradient-to-l","transform hover:-translate-y-1 hover:shadow-lg","w-full max-w-sm text-right"),children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-muted-foreground mb-1 text-xs font-medium",children:s("blog.detail.nextPost")}),e.jsx("div",{className:"group-hover:text-gray-700 truncate text-sm font-medium transition-colors",children:l.title})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(me,{className:"text-muted-foreground group-hover:text-foreground h-5 w-5 transition-colors"})})]}):e.jsx("div",{className:"w-full max-w-sm"})})]})})}const be=a.forwardRef(function({title:o,className:n},s){return e.jsx("div",{className:w("min-w-0 flex-1",n),children:e.jsxs(b.article,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},transition:{duration:.4},className:"max-w-none",children:[o&&e.jsx("header",{ref:s,className:"mb-10 space-y-6",children:o&&e.jsx("h1",{className:"text-left text-3xl font-bold tracking-tight text-balance text-blue-600 sm:text-4xl dark:text-blue-400",children:o})}),e.jsx(ne,{className:"mt-8",children:e.jsx(Y,{})}),e.jsx(se,{})]})})});function je({threshold:t=N.SCROLL_TO_TOP_THRESHOLD,className:o}){const[n,s]=a.useState(!1),{t:i}=E();a.useEffect(()=>{const l=A(()=>{const m=le();s(m>t)},16),c=document.querySelector(".scroll-container")||window;return c.addEventListener("scroll",l,{passive:!0}),l(),()=>{c.removeEventListener("scroll",l)}},[t]);const r=()=>{ae()};return e.jsx(O,{children:n&&e.jsx(b.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:r,className:`bg-gray-700 text-primary-foreground hover:bg-gray-800 focus:ring-primary/50 fixed right-8 bottom-8 z-50 rounded-full p-3 shadow-lg transition-colors duration-200 focus:ring-2 focus:ring-offset-2 focus:outline-none ${o||""}`,"aria-label":i("blog.detail.scrollToTop"),children:e.jsx(ce,{className:"h-5 w-5"})})})}function $({tocs:t,offset:o=N.HEADING_HIGHLIGHT_OFFSET,highlightBuffer:n=N.HIGHLIGHT_BUFFER}){const[s,i]=a.useState(""),r=a.useCallback((l,c)=>{l.preventDefault();const m=c.slice(1);ie(m,{offset:o,container:null})},[o]);return a.useEffect(()=>{const l=A(()=>{if(t.length===0)return;const c=t.map(u=>document.getElementById(u.url.slice(1))).filter(Boolean);if(c.length===0)return;const m=window.scrollY;let d="";for(const u of c)if(u.getBoundingClientRect().top+m<=m+o+n)d=u.id;else break;!d&&c.length>0&&(d=c[0].id),d!==s&&i(d)},16);return l(),window.addEventListener("scroll",l,{passive:!0}),()=>{window.removeEventListener("scroll",l)}},[t,s,o,n]),{activeId:s,handleClick:r}}const U=({tocs:t,activeId:o,progress:n,onLinkClick:s})=>{const i=Math.min(...t.map(r=>r.level??2));return e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"space-y-0.5",children:t.map(r=>{const l=o===r.url.slice(1),m={paddingLeft:`${((r.level??2)-i)*.5+.5}rem`};return e.jsx(K,{to:r.url,onClick:d=>s(d,r.url),style:m,className:w("block rounded py-1.5 pr-2 text-xs transition-all duration-200","text-zinc-600 hover:opacity-65","dark:text-white dark:opacity-75 dark:hover:opacity-40","group relative",l&&["font-medium text-zinc-900"]),children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:w("truncate leading-relaxed",l&&"font-medium"),children:r.value})})},r.url)})}),e.jsxs("div",{className:"mt-3 ml-2 inline-flex items-center justify-between gap-1.5 text-[10px] text-zinc-600",children:[e.jsx("div",{className:"radial-progress text-zinc-600",style:{"--value":n,"--size":"0.875rem"},"aria-valuenow":n,role:"progressbar"}),e.jsxs("div",{children:[Math.round(n),"%"]})]})]})};function Ce({tocs:t,className:o}){const[n,s]=a.useState(!1),{activeId:i,handleClick:r}=$({tocs:t}),{t:l}=E();if(t.length===0)return null;const c=t.findIndex(u=>u.url.slice(1)===i),m=c>=0?(c+1)/t.length*100:0,d=(u,f)=>{r(u,f),s(!1)};return e.jsxs("div",{className:w("lg:hidden",o),children:[e.jsx("button",{onClick:()=>s(!n),className:w("fixed top-20 right-4 z-40 rounded-full p-3","bg-background/80 border-border border backdrop-blur-sm","shadow-lg transition-all duration-200 hover:shadow-xl","text-muted-foreground hover:text-foreground",n&&"text-primary bg-primary/10"),"aria-label":l("blog.detail.mobileToggleToc"),children:e.jsx(b.div,{animate:{rotate:n?45:0},transition:{duration:.2},children:e.jsx("span",{className:"i-simple-line-icons-menu block h-5 w-5"})})}),e.jsx("div",{className:"fixed top-0 right-0 left-0 z-30 h-1 bg-gray-500/50",children:e.jsx("div",{className:"h-full bg-gray-700 transition-all duration-300 ease-out",style:{width:`${m}%`}})}),e.jsx(O,{children:n&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"bg-background/50 fixed inset-0 z-30 backdrop-blur-sm",onClick:()=>s(!1)})}),e.jsx(O,{children:n&&e.jsx(b.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},transition:{type:"spring",damping:20,stiffness:300},className:w("fixed top-0 right-0 bottom-0 z-40 w-80 max-w-[90vw]","bg-background border-border border-l shadow-2xl","overflow-y-auto overscroll-contain"),children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsx("button",{onClick:()=>s(!1),className:"hover:bg-accent text-muted-foreground hover:text-foreground rounded-md p-2","aria-label":l("blog.detail.mobileCloseToc"),children:e.jsx("span",{className:"i-lucide-x block h-4 w-4"})})}),e.jsx(U,{tocs:t,activeId:i,progress:m,onLinkClick:d})]})})})]})}function Ne({tocs:t,className:o}){const{activeId:n,handleClick:s}=$({tocs:t});if(t.length===0)return null;const i=t.findIndex(l=>l.url.slice(1)===n),r=i>=0?(i+1)/t.length*100:0;return e.jsx("div",{className:o,children:e.jsx(U,{tocs:t,activeId:n,progress:r,onLinkClick:s})})}const ke=({gitInfo:t})=>{const{t:o,locale:n}=E(),s=n==="zh"?"zh-CN":"en-US";return e.jsxs("details",{className:"text-muted-foreground group text-sm",children:[e.jsx("summary",{className:"cursor-pointer list-none",children:e.jsxs("span",{className:"hover:text-foreground inline-flex items-center gap-1.5",children:[e.jsx(fe,{className:"h-4 w-4"}),o("blog.detail.versionHistory")," (",t==null?void 0:t.commits.length,")",e.jsx(de,{className:"h-3 w-3 transition-transform group-open:rotate-180"})]})}),e.jsx("div",{className:"mt-3 space-y-2 pl-5",children:t==null?void 0:t.commits.slice(0,10).map(i=>e.jsxs("a",{className:"flex items-start gap-2 text-xs hover:opacity-65",href:i.githubUrl,target:"_blank",rel:"noreferrer",children:[e.jsx("code",{className:"text-muted-foreground/70 font-mono",children:i.hash}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"text-muted-foreground/70",children:[i.author," Â·"," ",new Date(i.date).toLocaleDateString(s)]})})]},i.hash))})]})};function Te({list:t}){var m,d;const{pathname:o}=G(),n=t.find(u=>u.url===o),s=(n==null?void 0:n.toc)??[],i=n==null?void 0:n.title,[r,l]=a.useState(!1),c=a.useRef(null);return a.useEffect(()=>{if(!c.current)return;const u=()=>{var h;const f=(h=c.current)==null?void 0:h.getBoundingClientRect();f&&l(f.bottom<80)};return u(),window.addEventListener("scroll",u,{passive:!0}),()=>window.removeEventListener("scroll",u)},[]),e.jsxs(e.Fragment,{children:[e.jsx(Ce,{tocs:s}),e.jsx(b.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4},className:"fixed top-30 left-4 z-40 hidden max-h-[calc(100vh-8rem)] w-56 pb-8 xl:block",children:e.jsx("div",{className:"max-h-[calc(100vh-12rem)] overflow-y-auto pr-2",children:e.jsx(Ne,{tocs:s,className:"w-full"})})}),e.jsxs("div",{className:"relative mx-auto w-full max-w-3xl px-4 sm:px-6 lg:px-8",children:[e.jsx(b.div,{initial:{opacity:0,y:-20},animate:{opacity:r?1:0,y:r?0:-20},transition:{duration:.2},className:`bg-background/80 fixed inset-x-0 top-0 z-50 border-b border-zinc-200/60 backdrop-blur-md transition ${r?"pointer-events-auto":"pointer-events-none"}`,children:e.jsx("div",{className:"mx-auto flex w-full max-w-3xl items-center justify-between px-4 py-3 sm:px-6",children:e.jsx("h1",{className:"truncate text-base font-semibold tracking-tight sm:text-lg",children:i})})}),e.jsxs("div",{className:"blog-detail-content blog-detail-scroll-container min-w-0",children:[e.jsx(be,{ref:c,title:i}),e.jsxs("div",{className:"mt-16 mb-8",children:[e.jsx("div",{className:"my-4",children:(((d=(m=n==null?void 0:n.gitInfo)==null?void 0:m.commits)==null?void 0:d.length)??0)>0&&e.jsx(ke,{gitInfo:n==null?void 0:n.gitInfo})}),e.jsx(ye,{list:t})]})]}),e.jsx(je,{})]})]})}function Ie(){return e.jsx(Te,{list:W})}export{Ie as default};
