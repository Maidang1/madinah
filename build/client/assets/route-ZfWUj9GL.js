import{j as e,r as a}from"./index-BZchTVqk.js";import{u as x,c as m}from"./i18n-provider-Cit72E0b.js";import{c as N,L as b,a as w,O as C,u as L,i as E}from"./components-raYoEFov.js";import{E as g}from"./error-state-g2K3_dPm.js";function S({book:s,activeChapterId:r,onNavigate:n}){const{t:o}=x(),c=N(),i=r??c.chapterId??s.defaultChapterId??null;return e.jsxs("nav",{className:"border-border/60 bg-background/80 dark:bg-background/60 flex flex-col gap-4 rounded-2xl border p-5 shadow-sm backdrop-blur",children:[e.jsxs("header",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground text-xs tracking-wide uppercase",children:o("books.sidebar.sectionLabel")}),e.jsx("h2",{className:"text-foreground text-base font-semibold",children:s.title}),s.description?e.jsx("p",{className:"text-muted-foreground mt-2 text-xs leading-relaxed",children:s.description}):null]}),e.jsx("ul",{className:"flex flex-1 flex-col gap-2 text-sm",children:s.chapters.map((d,l)=>{const t=i===d.id;return e.jsx("li",{children:e.jsxs(b,{to:`/books/${s.id}/${d.id}`,onClick:n,className:m("flex items-center gap-3 rounded-xl border border-transparent px-3 py-2 text-left transition",t?"border-gray-700 bg-gray-500/10 text-gray-700 dark:text-main-400":"text-muted-foreground hover:border-gray-700/40 hover:bg-gray-500/5"),prefetch:"intent",children:[e.jsx("span",{className:"bg-gray-500/10 text-gray-700 flex h-7 w-7 items-center justify-center rounded-full text-xs font-semibold",children:l+1}),e.jsx("span",{className:"flex-1 text-sm leading-snug",children:d.title})]})},d.id)})})]})}function M({sidebar:s,overview:r,children:n}){const[o,c]=a.useState(!1),i=a.useId(),d=a.useId(),{t:l}=x(),t=a.useCallback(()=>c(!1),[]),f=a.useCallback(()=>c(!0),[]);a.useEffect(()=>{if(!o)return;const h=v=>{v.key==="Escape"&&t()};window.addEventListener("keydown",h);const j=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",h),document.body.style.overflow=j}},[t,o]);const y=a.useMemo(()=>m("fixed inset-y-0 left-0 z-50 w-80 transform bg-white shadow-xl transition-transform duration-300 ease-in-out dark:bg-zinc-900 xl:hidden",o?"translate-x-0":"-translate-x-full"),[o]),k=a.useMemo(()=>m("fixed inset-0 z-40 bg-black/30 transition-opacity xl:hidden",o?"opacity-100 backdrop-blur":"pointer-events-none opacity-0"),[o]),p=a.useMemo(()=>s(t),[t,s]),u=a.useMemo(()=>r?r(t):null,[t,r]);return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{id:i,"aria-hidden":!o,className:y,children:[e.jsxs("div",{className:"flex h-full flex-col gap-6 overflow-y-auto p-6 pb-20",children:[u,p]}),e.jsxs("button",{type:"button","aria-controls":i,"aria-label":l("books.layout.closeSidebar"),className:"focus-visible:ring-gray-700 absolute top-4 right-4 rounded-full p-2 text-gray-500 transition hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus-visible:ring-2",onClick:t,children:[e.jsx("span",{className:"sr-only",children:l("books.layout.closeSidebar")}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsx("button",{id:d,type:"button","aria-controls":i,"aria-hidden":!o,"aria-label":l("books.layout.closeSidebar"),className:k,onClick:t,children:e.jsx("span",{className:"sr-only",children:l("books.layout.closeSidebar")})}),e.jsxs("button",{type:"button","aria-controls":i,"aria-expanded":o,"aria-label":l("books.layout.openSidebar"),className:"focus-visible:ring-gray-700 fixed top-4 left-4 z-30 rounded-md bg-white p-2 opacity-70 shadow-md transition hover:opacity-100 focus:outline-none focus-visible:ring-2 xl:hidden",onClick:f,children:[e.jsx("span",{className:"sr-only",children:l("books.layout.openSidebar")}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),e.jsx("div",{className:"relative mx-auto w-full max-w-5xl px-4 pt-6 pb-16 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"relative grid grid-cols-1 gap-12 xl:grid-cols-[minmax(0,1fr)_18rem]",children:[e.jsxs("div",{className:"min-w-0 space-y-10",children:[e.jsx("div",{className:"grid gap-6 xl:hidden",children:u}),n]}),e.jsx("aside",{className:"relative hidden xl:block",children:e.jsxs("div",{className:"sticky top-28 flex max-h-[calc(100vh-7rem)] flex-col gap-6",children:[u,e.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:p})]})})]})})]})}function B({book:s,overviewSlot:r}){const{t:n}=x();return e.jsxs("section",{className:"border-border/60 bg-background/80 dark:bg-background/60 rounded-2xl border p-6 shadow-sm backdrop-blur transition",children:[e.jsxs("header",{className:"mb-3 space-y-1",children:[e.jsx("p",{className:"text-gray-700 text-xs tracking-wide uppercase",children:n("books.overview.sectionLabel")}),e.jsx("h1",{className:"text-foreground text-xl font-semibold",children:s.title}),s.author?e.jsx("p",{className:"text-muted-foreground text-xs",children:n("books.overview.author",{replace:{name:s.author}})}):null]}),e.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:s.description}),r?e.jsx("div",{className:"text-foreground/80 mt-4 text-sm leading-relaxed",children:r}):null,s.tags.length?e.jsx("div",{className:"text-gray-700 mt-4 flex flex-wrap gap-2 text-xs",children:s.tags.map(o=>e.jsxs("span",{className:"border-gray-700/40 rounded-full border px-2 py-1",children:["#",o]},o))}):null]})}function T(){const{book:s}=w();return e.jsx(M,{overview:()=>e.jsx(B,{book:s}),sidebar:r=>e.jsx(S,{book:s,onNavigate:r}),children:e.jsx(C,{context:{book:s}})})}function F(){var n;const s=L(),{t:r}=x();return E(s)?e.jsx(g,{title:s.status===404?r("books.errors.bookNotFound"):r("books.errors.bookLoadFailed"),message:typeof s.data=="string"?s.data:((n=s.data)==null?void 0:n.error)??s.statusText,action:e.jsx(b,{to:"/books",className:"bg-gray-700 hover:bg-gray-900 inline-flex items-center rounded-full px-4 py-2 text-sm font-semibold text-white transition",children:r("books.errors.goToBooks")})}):e.jsx(g,{title:r("books.errors.bookRenderFailed"),message:s instanceof Error?s.message:r("books.errors.bookRenderMessage"),action:e.jsx(b,{to:"/books",className:"bg-gray-700 hover:bg-gray-900 inline-flex items-center rounded-full px-4 py-2 text-sm font-semibold text-white transition",children:r("books.errors.goToBooks")})})}export{F as ErrorBoundary,T as default};
