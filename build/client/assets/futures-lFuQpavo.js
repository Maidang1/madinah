import{j as s}from"./index-BZchTVqk.js";import{u as c}from"./index-CFAftGZl.js";const i={title:"Future 与执行器",order:2,summary:"深入理解 Future trait、Pin 与执行器如何协作驱动任务前进。"};function n(e){const l={a:"a",code:"code",div:"div",h1:"h1",h2:"h2",p:"p",pre:"pre",span:"span",...c(),...e.components};return s.jsxs(s.Fragment,{children:[s.jsxs(l.h1,{id:"future-的本质",children:["Future 的本质",s.jsx(l.a,{className:"header-anchor",href:"#future-的本质",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsxs(l.p,{children:[s.jsx(l.code,{children:"Future"})," 是一个状态机，封装了某个异步计算的推进逻辑。核心方法是 ",s.jsx(l.code,{children:"poll"}),"，它会返回一个 ",s.jsx(l.code,{children:"Poll::Ready"})," 或 ",s.jsx(l.code,{children:"Poll::Pending"}),"。"]}),`
`,s.jsxs(l.pre,{className:"shiki dark-plus",style:{backgroundColor:"#1E1E1E",color:"#D4D4D4"},children:[s.jsx(l.div,{className:"language-id",children:"rust"}),s.jsx(l.div,{className:"code-container",children:s.jsxs(l.code,{children:[s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#569CD6"},children:"impl"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Future"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"for"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"MyFuture"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"type"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Output"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" = "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"usize"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:";"})]}),s.jsx(l.div,{className:"line"}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"fn"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" "}),s.jsx(l.span,{style:{color:"#DCDCAA"},children:"poll"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"("}),s.jsx(l.span,{style:{color:"#569CD6"},children:"self"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Pin"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"<&"}),s.jsx(l.span,{style:{color:"#569CD6"},children:"mut"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"Self"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:">, "}),s.jsx(l.span,{style:{color:"#9CDCFE"},children:"cx"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:": &"}),s.jsx(l.span,{style:{color:"#569CD6"},children:"mut"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Context"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"<'"}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"_"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:">) -> "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Poll"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"<"}),s.jsx(l.span,{style:{color:"#569CD6"},children:"Self"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"::"}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Output"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"> {"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"if"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" "}),s.jsx(l.span,{style:{color:"#569CD6"},children:"self"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"."}),s.jsx(l.span,{style:{color:"#DCDCAA"},children:"is_ready"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"() {"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Poll"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"::"}),s.jsx(l.span,{style:{color:"#DCDCAA"},children:"Ready"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"("}),s.jsx(l.span,{style:{color:"#569CD6"},children:"self"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:".value)"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        } "}),s.jsx(l.span,{style:{color:"#C586C0"},children:"else"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#9CDCFE"},children:"cx"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"."}),s.jsx(l.span,{style:{color:"#DCDCAA"},children:"waker"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"()."}),s.jsx(l.span,{style:{color:"#DCDCAA"},children:"wake_by_ref"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"();"})]}),s.jsxs(l.div,{className:"line",children:[s.jsx(l.span,{style:{color:"#D4D4D4"},children:"            "}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Poll"}),s.jsx(l.span,{style:{color:"#D4D4D4"},children:"::"}),s.jsx(l.span,{style:{color:"#4EC9B0"},children:"Pending"})]}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#D4D4D4"},children:"        }"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#D4D4D4"},children:"    }"})}),s.jsx(l.div,{className:"line",children:s.jsx(l.span,{style:{color:"#D4D4D4"},children:"}"})})]})})]}),`
`,s.jsxs(l.h2,{id:"执行器executor",children:["执行器（Executor）",s.jsx(l.a,{className:"header-anchor",href:"#执行器executor",children:s.jsx(l.span,{className:"icon icon-link"})})]}),`
`,s.jsxs(l.p,{children:["执行器负责轮询 Future。当 Future 返回 ",s.jsx(l.code,{children:"Poll::Pending"})," 时，它会通过 ",s.jsx(l.code,{children:"Waker"})," 注册唤醒逻辑。常见的执行器有 ",s.jsx(l.code,{children:"tokio"}),", ",s.jsx(l.code,{children:"async-std"}),", 以及标准库中的 ",s.jsx(l.code,{children:"futures::executor"}),"。"]}),`
`,s.jsx(l.p,{children:"合理地选择执行器、任务调度策略和超时机制，是构建高性能服务的关键。"})]})}function d(e={}){const{wrapper:l}={...c(),...e.components};return l?s.jsx(l,{...e,children:s.jsx(n,{...e})}):n(e)}export{d as default,i as matter};
