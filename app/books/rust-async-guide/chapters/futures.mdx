---
title: Future 与执行器
order: 2
summary: 深入理解 Future trait、Pin 与执行器如何协作驱动任务前进。
---

# Future 的本质

`Future` 是一个状态机，封装了某个异步计算的推进逻辑。核心方法是 `poll`，它会返回一个 `Poll::Ready` 或 `Poll::Pending`。

```rust
impl Future for MyFuture {
    type Output = usize;

    fn poll(self: Pin<&mut Self>, cx: &mut Context<'_>) -> Poll<Self::Output> {
        if self.is_ready() {
            Poll::Ready(self.value)
        } else {
            cx.waker().wake_by_ref();
            Poll::Pending
        }
    }
}
```

## 执行器（Executor）

执行器负责轮询 Future。当 Future 返回 `Poll::Pending` 时，它会通过 `Waker` 注册唤醒逻辑。常见的执行器有 `tokio`, `async-std`, 以及标准库中的 `futures::executor`。

合理地选择执行器、任务调度策略和超时机制，是构建高性能服务的关键。
