#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Generate Git history cache before push
echo "ğŸ”„ Generating Git history cache..."
pnpm run git:cache

# Add the generated cache file to the commit if it changed
if [ -f "app/data/git-history.json" ]; then
  git add app/data/git-history.json
  
  # Check if there are changes to commit
  if ! git diff --cached --quiet app/data/git-history.json 2>/dev/null; then
    echo "ğŸ“ Committing updated Git history cache..."
    git commit -m "chore: update git history cache [skip ci]" --no-verify
  fi
fi

echo "âœ… Git history cache updated"
